Processing batch 0
+---------+-----+---------+
|timestamp|value|div_error|
+---------+-----+---------+
+---------+-----+---------+

Schema Mismatch Error in batch 0: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `non_existent` cannot be resolved. Did you mean one of the following? [`timestamp`, `value`].;
'Project ['non_existent]
+- LogicalRDD [timestamp#0, value#1L], false

Selecting correct column instead:
+-----+
|value|
+-----+
+-----+

+---------+-----+----------+
|timestamp|value|udf_result|
+---------+-----+----------+
+---------+-----+----------+

Processing batch 1
+-----------------------+-----+---------+
|timestamp              |value|div_error|
+-----------------------+-----+---------+
|2025-02-26 05:19:32.381|0    |NULL     |
|2025-02-26 05:19:32.781|2    |NULL     |
|2025-02-26 05:19:33.181|4    |NULL     |
|2025-02-26 05:19:32.581|1    |NULL     |
|2025-02-26 05:19:32.981|3    |NULL     |
+-----------------------+-----+---------+

Schema Mismatch Error in batch 1: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `non_existent` cannot be resolved. Did you mean one of the following? [`timestamp`, `value`].;
'Project ['non_existent]
+- LogicalRDD [timestamp#0, value#1L], false

Selecting correct column instead:
+-----+
|value|
+-----+
|0    |
|2    |
|4    |
|1    |
|3    |
+-----+

+-----------------------+-----+----------+
|timestamp              |value|udf_result|
+-----------------------+-----+----------+
|2025-02-26 05:19:32.381|0    |0         |
|2025-02-26 05:19:32.781|2    |2         |
|2025-02-26 05:19:33.181|4    |4         |
|2025-02-26 05:19:32.581|1    |1         |
|2025-02-26 05:19:32.981|3    |3         |
+-----------------------+-----+----------+

Processing batch 2
+-----------------------+-----+---------+
|timestamp              |value|div_error|
+-----------------------+-----+---------+
|2025-02-26 05:19:33.381|5    |NULL     |
|2025-02-26 05:19:33.781|7    |NULL     |
|2025-02-26 05:19:34.181|9    |NULL     |
|2025-02-26 05:19:34.581|11   |NULL     |
|2025-02-26 05:19:34.981|13   |NULL     |
|2025-02-26 05:19:35.381|15   |NULL     |
|2025-02-26 05:19:35.781|17   |NULL     |
|2025-02-26 05:19:36.181|19   |NULL     |
|2025-02-26 05:19:36.581|21   |NULL     |
|2025-02-26 05:19:36.981|23   |NULL     |
|2025-02-26 05:19:37.381|25   |NULL     |
|2025-02-26 05:19:37.781|27   |NULL     |
|2025-02-26 05:19:38.181|29   |NULL     |
|2025-02-26 05:19:33.581|6    |NULL     |
|2025-02-26 05:19:33.981|8    |NULL     |
|2025-02-26 05:19:34.381|10   |NULL     |
|2025-02-26 05:19:34.781|12   |NULL     |
|2025-02-26 05:19:35.181|14   |NULL     |
|2025-02-26 05:19:35.581|16   |NULL     |
|2025-02-26 05:19:35.981|18   |NULL     |
+-----------------------+-----+---------+
only showing top 20 rows

Schema Mismatch Error in batch 2: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `non_existent` cannot be resolved. Did you mean one of the following? [`timestamp`, `value`].;
'Project ['non_existent]
+- LogicalRDD [timestamp#0, value#1L], false

Selecting correct column instead:
+-----+
|value|
+-----+
|5    |
|7    |
|9    |
|11   |
|13   |
|15   |
|17   |
|19   |
|21   |
|23   |
|25   |
|27   |
|29   |
|6    |
|8    |
|10   |
|12   |
|14   |
|16   |
|18   |
+-----+
only showing top 20 rows

UDF Error in batch 2: 
  An exception was thrown from the Python worker. Please see the stack trace below.
Traceback (most recent call last):
  File "/opt/spark/work-dir/simulations/8_spark_streaming.py", line 18, in faulty_udf
Exception: Simulated error in UDF for value 5

Fixed UDF error:
+-----------------------+-----+----------+
|timestamp              |value|udf_result|
+-----------------------+-----+----------+
|2025-02-26 05:19:33.381|5    |0         |
|2025-02-26 05:19:33.781|7    |7         |
|2025-02-26 05:19:34.181|9    |9         |
|2025-02-26 05:19:34.581|11   |11        |
|2025-02-26 05:19:34.981|13   |13        |
|2025-02-26 05:19:35.381|15   |15        |
|2025-02-26 05:19:35.781|17   |17        |
|2025-02-26 05:19:36.181|19   |19        |
|2025-02-26 05:19:36.581|21   |21        |
|2025-02-26 05:19:36.981|23   |23        |
|2025-02-26 05:19:37.381|25   |25        |
|2025-02-26 05:19:37.781|27   |27        |
|2025-02-26 05:19:38.181|29   |29        |
|2025-02-26 05:19:33.581|6    |6         |
|2025-02-26 05:19:33.981|8    |8         |
|2025-02-26 05:19:34.381|10   |10        |
|2025-02-26 05:19:34.781|12   |12        |
|2025-02-26 05:19:35.181|14   |14        |
|2025-02-26 05:19:35.581|16   |16        |
|2025-02-26 05:19:35.981|18   |18        |
+-----------------------+-----+----------+
only showing top 20 rows

Processing batch 3
+-----------------------+-----+---------+
|timestamp              |value|div_error|
+-----------------------+-----+---------+
|2025-02-26 05:19:38.381|30   |NULL     |
|2025-02-26 05:19:38.781|32   |NULL     |
|2025-02-26 05:19:39.181|34   |NULL     |
|2025-02-26 05:19:39.581|36   |NULL     |
|2025-02-26 05:19:39.981|38   |NULL     |
|2025-02-26 05:19:38.581|31   |NULL     |
|2025-02-26 05:19:38.981|33   |NULL     |
|2025-02-26 05:19:39.381|35   |NULL     |
|2025-02-26 05:19:39.781|37   |NULL     |
|2025-02-26 05:19:40.181|39   |NULL     |
+-----------------------+-----+---------+

Schema Mismatch Error in batch 3: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `non_existent` cannot be resolved. Did you mean one of the following? [`timestamp`, `value`].;
'Project ['non_existent]
+- LogicalRDD [timestamp#0, value#1L], false

Selecting correct column instead:
+-----+
|value|
+-----+
|30   |
|32   |
|34   |
|36   |
|38   |
|31   |
|33   |
|35   |
|37   |
|39   |
+-----+

+-----------------------+-----+----------+
|timestamp              |value|udf_result|
+-----------------------+-----+----------+
|2025-02-26 05:19:38.381|30   |30        |
|2025-02-26 05:19:38.781|32   |32        |
|2025-02-26 05:19:39.181|34   |34        |
|2025-02-26 05:19:39.581|36   |36        |
|2025-02-26 05:19:39.981|38   |38        |
|2025-02-26 05:19:38.581|31   |31        |
|2025-02-26 05:19:38.981|33   |33        |
|2025-02-26 05:19:39.381|35   |35        |
|2025-02-26 05:19:39.781|37   |37        |
|2025-02-26 05:19:40.181|39   |39        |
+-----------------------+-----+----------+

Processing batch 4
+-----------------------+-----+---------+
|timestamp              |value|div_error|
+-----------------------+-----+---------+
|2025-02-26 05:19:40.381|40   |NULL     |
|2025-02-26 05:19:40.781|42   |NULL     |
|2025-02-26 05:19:41.181|44   |NULL     |
|2025-02-26 05:19:40.581|41   |NULL     |
|2025-02-26 05:19:40.981|43   |NULL     |
+-----------------------+-----+---------+

Schema Mismatch Error in batch 4: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `non_existent` cannot be resolved. Did you mean one of the following? [`timestamp`, `value`].;
'Project ['non_existent]
+- LogicalRDD [timestamp#0, value#1L], false

Selecting correct column instead:
+-----+
|value|
+-----+
|40   |
|42   |
|44   |
|41   |
|43   |
+-----+

+-----------------------+-----+----------+
|timestamp              |value|udf_result|
+-----------------------+-----+----------+
|2025-02-26 05:19:40.381|40   |40        |
|2025-02-26 05:19:40.781|42   |42        |
|2025-02-26 05:19:41.181|44   |44        |
|2025-02-26 05:19:40.581|41   |41        |
|2025-02-26 05:19:40.981|43   |43        |
+-----------------------+-----+----------+

Processing batch 5
+-----------------------+-----+---------+
|timestamp              |value|div_error|
+-----------------------+-----+---------+
|2025-02-26 05:19:41.381|45   |NULL     |
|2025-02-26 05:19:41.781|47   |NULL     |
|2025-02-26 05:19:42.181|49   |NULL     |
|2025-02-26 05:19:41.581|46   |NULL     |
|2025-02-26 05:19:41.981|48   |NULL     |
+-----------------------+-----+---------+

Schema Mismatch Error in batch 5: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `non_existent` cannot be resolved. Did you mean one of the following? [`timestamp`, `value`].;
'Project ['non_existent]
+- LogicalRDD [timestamp#0, value#1L], false

Selecting correct column instead:
+-----+
|value|
+-----+
|45   |
|47   |
|49   |
|46   |
|48   |
+-----+

+-----------------------+-----+----------+
|timestamp              |value|udf_result|
+-----------------------+-----+----------+
|2025-02-26 05:19:41.381|45   |45        |
|2025-02-26 05:19:41.781|47   |47        |
|2025-02-26 05:19:42.181|49   |49        |
|2025-02-26 05:19:41.581|46   |46        |
|2025-02-26 05:19:41.981|48   |48        |
+-----------------------+-----+----------+

Processing batch 6
+-----------------------+-----+---------+
|timestamp              |value|div_error|
+-----------------------+-----+---------+
|2025-02-26 05:19:42.381|50   |NULL     |
|2025-02-26 05:19:42.781|52   |NULL     |
|2025-02-26 05:19:43.181|54   |NULL     |
|2025-02-26 05:19:42.581|51   |NULL     |
|2025-02-26 05:19:42.981|53   |NULL     |
+-----------------------+-----+---------+

Schema Mismatch Error in batch 6: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `non_existent` cannot be resolved. Did you mean one of the following? [`timestamp`, `value`].;
'Project ['non_existent]
+- LogicalRDD [timestamp#0, value#1L], false

Selecting correct column instead:
+-----+
|value|
+-----+
|50   |
|52   |
|54   |
|51   |
|53   |
+-----+

+-----------------------+-----+----------+
|timestamp              |value|udf_result|
+-----------------------+-----+----------+
|2025-02-26 05:19:42.381|50   |50        |
|2025-02-26 05:19:42.781|52   |52        |
|2025-02-26 05:19:43.181|54   |54        |
|2025-02-26 05:19:42.581|51   |51        |
|2025-02-26 05:19:42.981|53   |53        |
+-----------------------+-----+----------+

Processing batch 7
+-----------------------+-----+---------+
|timestamp              |value|div_error|
+-----------------------+-----+---------+
|2025-02-26 05:19:43.381|55   |NULL     |
|2025-02-26 05:19:43.781|57   |NULL     |
|2025-02-26 05:19:44.181|59   |NULL     |
|2025-02-26 05:19:43.581|56   |NULL     |
|2025-02-26 05:19:43.981|58   |NULL     |
+-----------------------+-----+---------+

Schema Mismatch Error in batch 7: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `non_existent` cannot be resolved. Did you mean one of the following? [`timestamp`, `value`].;
'Project ['non_existent]
+- LogicalRDD [timestamp#0, value#1L], false

Selecting correct column instead:
+-----+
|value|
+-----+
|55   |
|57   |
|59   |
|56   |
|58   |
+-----+

+-----------------------+-----+----------+
|timestamp              |value|udf_result|
+-----------------------+-----+----------+
|2025-02-26 05:19:43.381|55   |55        |
|2025-02-26 05:19:43.781|57   |57        |
|2025-02-26 05:19:44.181|59   |59        |
|2025-02-26 05:19:43.581|56   |56        |
|2025-02-26 05:19:43.981|58   |58        |
+-----------------------+-----+----------+

Processing batch 8
+-----------------------+-----+---------+
|timestamp              |value|div_error|
+-----------------------+-----+---------+
|2025-02-26 05:19:44.381|60   |NULL     |
|2025-02-26 05:19:44.781|62   |NULL     |
|2025-02-26 05:19:45.181|64   |NULL     |
|2025-02-26 05:19:44.581|61   |NULL     |
|2025-02-26 05:19:44.981|63   |NULL     |
+-----------------------+-----+---------+

Schema Mismatch Error in batch 8: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `non_existent` cannot be resolved. Did you mean one of the following? [`timestamp`, `value`].;
'Project ['non_existent]
+- LogicalRDD [timestamp#0, value#1L], false

Selecting correct column instead:
+-----+
|value|
+-----+
|60   |
|62   |
|64   |
|61   |
|63   |
+-----+

+-----------------------+-----+----------+
|timestamp              |value|udf_result|
+-----------------------+-----+----------+
|2025-02-26 05:19:44.381|60   |60        |
|2025-02-26 05:19:44.781|62   |62        |
|2025-02-26 05:19:45.181|64   |64        |
|2025-02-26 05:19:44.581|61   |61        |
|2025-02-26 05:19:44.981|63   |63        |
+-----------------------+-----+----------+

Processing batch 9
+-----------------------+-----+---------+
|timestamp              |value|div_error|
+-----------------------+-----+---------+
|2025-02-26 05:19:45.381|65   |NULL     |
|2025-02-26 05:19:45.781|67   |NULL     |
|2025-02-26 05:19:46.181|69   |NULL     |
|2025-02-26 05:19:45.581|66   |NULL     |
|2025-02-26 05:19:45.981|68   |NULL     |
+-----------------------+-----+---------+

Schema Mismatch Error in batch 9: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `non_existent` cannot be resolved. Did you mean one of the following? [`timestamp`, `value`].;
'Project ['non_existent]
+- LogicalRDD [timestamp#0, value#1L], false

Selecting correct column instead:
+-----+
|value|
+-----+
|65   |
|67   |
|69   |
|66   |
|68   |
+-----+

+-----------------------+-----+----------+
|timestamp              |value|udf_result|
+-----------------------+-----+----------+
|2025-02-26 05:19:45.381|65   |65        |
|2025-02-26 05:19:45.781|67   |67        |
|2025-02-26 05:19:46.181|69   |69        |
|2025-02-26 05:19:45.581|66   |66        |
|2025-02-26 05:19:45.981|68   |68        |
+-----------------------+-----+----------+

Processing batch 10
+-----------------------+-----+---------+
|timestamp              |value|div_error|
+-----------------------+-----+---------+
|2025-02-26 05:19:46.381|70   |NULL     |
|2025-02-26 05:19:46.781|72   |NULL     |
|2025-02-26 05:19:47.181|74   |NULL     |
|2025-02-26 05:19:46.581|71   |NULL     |
|2025-02-26 05:19:46.981|73   |NULL     |
+-----------------------+-----+---------+

Schema Mismatch Error in batch 10: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `non_existent` cannot be resolved. Did you mean one of the following? [`timestamp`, `value`].;
'Project ['non_existent]
+- LogicalRDD [timestamp#0, value#1L], false

Selecting correct column instead:
+-----+
|value|
+-----+
|70   |
|72   |
|74   |
|71   |
|73   |
+-----+

+-----------------------+-----+----------+
|timestamp              |value|udf_result|
+-----------------------+-----+----------+
|2025-02-26 05:19:46.381|70   |70        |
|2025-02-26 05:19:46.781|72   |72        |
|2025-02-26 05:19:47.181|74   |74        |
|2025-02-26 05:19:46.581|71   |71        |
|2025-02-26 05:19:46.981|73   |73        |
+-----------------------+-----+----------+

Processing batch 11
+-----------------------+-----+---------+
|timestamp              |value|div_error|
+-----------------------+-----+---------+
|2025-02-26 05:19:47.381|75   |NULL     |
|2025-02-26 05:19:47.781|77   |NULL     |
|2025-02-26 05:19:48.181|79   |NULL     |
|2025-02-26 05:19:47.581|76   |NULL     |
|2025-02-26 05:19:47.981|78   |NULL     |
+-----------------------+-----+---------+

Schema Mismatch Error in batch 11: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `non_existent` cannot be resolved. Did you mean one of the following? [`timestamp`, `value`].;
'Project ['non_existent]
+- LogicalRDD [timestamp#0, value#1L], false

Selecting correct column instead:
+-----+
|value|
+-----+
|75   |
|77   |
|79   |
|76   |
|78   |
+-----+

+-----------------------+-----+----------+
|timestamp              |value|udf_result|
+-----------------------+-----+----------+
|2025-02-26 05:19:47.381|75   |75        |
|2025-02-26 05:19:47.781|77   |77        |
|2025-02-26 05:19:48.181|79   |79        |
|2025-02-26 05:19:47.581|76   |76        |
|2025-02-26 05:19:47.981|78   |78        |
+-----------------------+-----+----------+

Processing batch 12
+-----------------------+-----+---------+
|timestamp              |value|div_error|
+-----------------------+-----+---------+
|2025-02-26 05:19:48.381|80   |NULL     |
|2025-02-26 05:19:48.781|82   |NULL     |
|2025-02-26 05:19:49.181|84   |NULL     |
|2025-02-26 05:19:48.581|81   |NULL     |
|2025-02-26 05:19:48.981|83   |NULL     |
+-----------------------+-----+---------+

Schema Mismatch Error in batch 12: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `non_existent` cannot be resolved. Did you mean one of the following? [`timestamp`, `value`].;
'Project ['non_existent]
+- LogicalRDD [timestamp#0, value#1L], false

Selecting correct column instead:
+-----+
|value|
+-----+
|80   |
|82   |
|84   |
|81   |
|83   |
+-----+

+-----------------------+-----+----------+
|timestamp              |value|udf_result|
+-----------------------+-----+----------+
|2025-02-26 05:19:48.381|80   |80        |
|2025-02-26 05:19:48.781|82   |82        |
|2025-02-26 05:19:49.181|84   |84        |
|2025-02-26 05:19:48.581|81   |81        |
|2025-02-26 05:19:48.981|83   |83        |
+-----------------------+-----+----------+

Processing batch 13
+-----------------------+-----+---------+
|timestamp              |value|div_error|
+-----------------------+-----+---------+
|2025-02-26 05:19:49.381|85   |NULL     |
|2025-02-26 05:19:49.781|87   |NULL     |
|2025-02-26 05:19:50.181|89   |NULL     |
|2025-02-26 05:19:49.581|86   |NULL     |
|2025-02-26 05:19:49.981|88   |NULL     |
+-----------------------+-----+---------+

Schema Mismatch Error in batch 13: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `non_existent` cannot be resolved. Did you mean one of the following? [`timestamp`, `value`].;
'Project ['non_existent]
+- LogicalRDD [timestamp#0, value#1L], false

Selecting correct column instead:
+-----+
|value|
+-----+
|85   |
|87   |
|89   |
|86   |
|88   |
+-----+

+-----------------------+-----+----------+
|timestamp              |value|udf_result|
+-----------------------+-----+----------+
|2025-02-26 05:19:49.381|85   |85        |
|2025-02-26 05:19:49.781|87   |87        |
|2025-02-26 05:19:50.181|89   |89        |
|2025-02-26 05:19:49.581|86   |86        |
|2025-02-26 05:19:49.981|88   |88        |
+-----------------------+-----+----------+

Processing batch 14
+-----------------------+-----+---------+
|timestamp              |value|div_error|
+-----------------------+-----+---------+
|2025-02-26 05:19:50.381|90   |NULL     |
|2025-02-26 05:19:50.781|92   |NULL     |
|2025-02-26 05:19:51.181|94   |NULL     |
|2025-02-26 05:19:50.581|91   |NULL     |
|2025-02-26 05:19:50.981|93   |NULL     |
+-----------------------+-----+---------+

Schema Mismatch Error in batch 14: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `non_existent` cannot be resolved. Did you mean one of the following? [`timestamp`, `value`].;
'Project ['non_existent]
+- LogicalRDD [timestamp#0, value#1L], false

Selecting correct column instead:
+-----+
|value|
+-----+
|90   |
|92   |
|94   |
|91   |
|93   |
+-----+

+-----------------------+-----+----------+
|timestamp              |value|udf_result|
+-----------------------+-----+----------+
|2025-02-26 05:19:50.381|90   |90        |
|2025-02-26 05:19:50.781|92   |92        |
|2025-02-26 05:19:51.181|94   |94        |
|2025-02-26 05:19:50.581|91   |91        |
|2025-02-26 05:19:50.981|93   |93        |
+-----------------------+-----+----------+

Processing batch 15
+-----------------------+-----+---------+
|timestamp              |value|div_error|
+-----------------------+-----+---------+
|2025-02-26 05:19:51.381|95   |NULL     |
|2025-02-26 05:19:51.781|97   |NULL     |
|2025-02-26 05:19:52.181|99   |NULL     |
|2025-02-26 05:19:51.581|96   |NULL     |
|2025-02-26 05:19:51.981|98   |NULL     |
+-----------------------+-----+---------+

Schema Mismatch Error in batch 15: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `non_existent` cannot be resolved. Did you mean one of the following? [`timestamp`, `value`].;
'Project ['non_existent]
+- LogicalRDD [timestamp#0, value#1L], false

Selecting correct column instead:
+-----+
|value|
+-----+
|95   |
|97   |
|99   |
|96   |
|98   |
+-----+

+-----------------------+-----+----------+
|timestamp              |value|udf_result|
+-----------------------+-----+----------+
|2025-02-26 05:19:51.381|95   |95        |
|2025-02-26 05:19:51.781|97   |97        |
|2025-02-26 05:19:52.181|99   |99        |
|2025-02-26 05:19:51.581|96   |96        |
|2025-02-26 05:19:51.981|98   |98        |
+-----------------------+-----+----------+

